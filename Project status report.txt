نکته باید سیستمی ایجاد کنم که در صورت امتخاب گزینه انتقال در ترامنش بخش دریافت کننده به صورت لیست حساب ها در بیاید و بخش ماده حساب،‌گروه و بابنت ها خالی شود. و مبلغ از حسابی به حساب دیگر منتقل شود.

کاربرگ تراکنش:
- ستون «افراد (اعضا)» تنظیم شد و به جدول PersonsTable موجود در کاربرگ «تنظیمات حساب» به صورت لیست پویا متصل شد.

- در طرح اولیه ستون «برچسب‌ها» وجود داشت که اکنون حذف شده است.

- ستون «تاریخ» تنظیم شد به صورتی که تاریخ را با تابع date به صورت میلادی دریافت می کند و به صورت شمسی نمایش می دهد.

- ستون «تراکنش» تنظیم شد و به جدول TypeOfTransactionTable موجود در کاربرک «تنظیمات دفترچه» به صورت لیست پویا متصل شد.

- ستون «گروه (درآمد/هزینه) به ستون «تراکنش» به صورت لیست وابسته پیوست داده شد.

- ستون «زیر گروه» به ستون «گروه» به صورت لیست وابسته پیوست داده شد.

- ستون «روش تراکنش» ایجاد شد و در آن روش تراکنش ثبت می شود. جدول «روش‌های تراکنش» در کاربرگ «تنظیمات دفترچه» موجود است.

- ستون «مبلغ» به عنوان ستون از نوع داده مالی «ریال» تنظیم شد.

- ستون‌های  «پرداخت کننده» و «دریافت کننده» تنظیم شدند، لیست کشویی آن‌ها به ستون «Accounts and ReceiversAndPayers از جدول Accounts_and_ReceiversAndPayers_AppendTabel موجود در در کاربرگ «دریافت کنندگان - پرداخت کنندگان» به صورت نیمه پویا متصل شدند.

- ستون «نوع خرج» تنظیم شد و ه جدول TypeOfExpenditureTable موجود در کاربرگ «تنظیمات دفترچه» به صورت لیست پویا متصل شد.
کد هر ردیف از ستون «نوع خرج»:
=INDIRECT("TypeOfExpenditureTable[نوع خرج]")

- 

کاربرگ «گروه‌های درآمدی»:
- جدول گروه های اصلی درآمد ایجاد شد.

- زیر گروه های ایجاد شدند.

کاربرگ «گروه‌های (بابت‌ها) هزینه»:
-جدول گروه‌های اصلی هزینه ایجاد شد. ۴ تیر ۱۴۰۰: جدول مقداری ویرایش شد. ۷ تیر ۱۴۰۰ جدول ویرایش شد و تمامی گروه های هزینه نوشته شدند. ۹ تیر ۱۴۰۰ تمامی گروه های هزینه ها تبدیل به جدول شدند و متغیر های نام دار برای هر کدام از آن ها ایجاد شد.


کاربرگ «دریافت کنندگان - پرداخت کنندگان»:
- جدول ReceiversAndPayersTable با سر تیتر «دریافت کننده - پرداخت کنندگان» در این کاربرگ وجود دارد و اطلاعات افرادی حقیقی یا حقوقی که با آن ها تعامل مالی دارم قرار دارد.

- جدول ایجاد شده با power query که مجموع لیست حساب های شخصی و دریافت کنندگان و پرداخت کنندگان را نمایش می دهد در این کاربرگگ وجود دارد.
برای افزودن افراد باید در جدول «دریافت کنندگان - پرداخت کنندگان» ثبت شود و سپس از تب Data بر روی گزینه Refresh All کلیک شود.


کاربرگ «تنظیمات حساب»:
جدول PersonsTable که اطلاعات افراد را در خود دارد.

جدول FinancialAccountsTable که اطلاعات حساب ها در آن وجود دارد.


کاربرگ «تنظیمات دفترچه»:
جدول TypeOfExpenditureTable که نوع خرج را در خود دارد (نامشخص، صحیح، اضافه)

جدول TypeOfTransactionTable که انواع تراکنش ها را در خود دارد (پرداخت، دریافت، انتقال).